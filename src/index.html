<!DOCTYPE html>
<html lang="en">
  <head>
    <title>D3</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" src="js/d3.v3.min.js"></script>
    <style>
      body {
        margin: 0px;
        padding: 0px;
        font-family: 'Avenir';
      }

      h1,
      button {
        margin-left: 25px;
        text-align: left;
      }

      button {
        margin-bottom: 25px;
      }

      .main {
        margin: 0px 25px;
      }

      svg {
        border: 1px dotted black;
        padding: 20px 40px;
      }

      .axis path,
      .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
      }

      .axis text {
        font-size: 11px;
      }
    </style>
  </head>
  <body>
    <h1>Interactive Data Visualization with D3</h1>

    <button>Refresh</button>

    <div class="main"></div>

    <script type="text/javascript">

      function render(){
        // Create an empty array and file it with 25 random numbers b/t 0 and 30
        var dataset = [];
        for (i=0; i < 25; i++){
          dataset.push(Math.floor((Math.random() * 30) + 1));
        }

        // Dimensions for the chart: height, width, and space b/t the bars
        var height = 600,
          width = 1000,
          barPadding = 1

        // Create a scale for the y-axis based on data
        // >> Domain - min and max values in the dataset
        // >> Range - physical range of the scale (reversed)
        var yScale = d3.scale.linear()
          .domain([0, d3.max(dataset)])
          .range([height, 0]);

        // Implements the scale as an actual axis
        // >> Orient - places the axis on the left of the graph
        // >> Ticks - number of points on the axis, automated
        var yAxis = d3.svg.axis()
          .scale(yScale)
          .orient('left')
          .ticks(5);

        // Creates the initial space for the chart
        // >> Select - grabs the empty <div> above this script
        // >> Append - places an <svg> wrapper inside the div
        // >> Attr - applies our height & width values from above
        var chart = d3.select('.main')
          .append('svg')
          .attr('width', width)
          .attr('height', height);

        // For each value in our dataset, places and styles a bar on the chart

        // Step 1: selectAll.data.enter.append
        // >> Loops through the dataset and appends a rectangle for each value
        chart.selectAll('rect')
          .data(dataset)
          .enter()
          .append('rect')

          // Step 2: X & Y
          // >> X - Places the bars in horizontal order, based on number of
          //        points & the width of the chart
          // >> Y - Places vertically based on scale
          .attr('x', function(d, i){
            return i * (width / dataset.length);
          })
          .attr('y', function(d){
            return yScale(d);
          })

          // Step 3: Height & Width
          // >> Width - Based on barpadding and number of points in dataset
          // >> Height - Scale and height of the chart area
          .attr('width', (width / dataset.length) - barPadding)
          .attr('height', function(d){
            return height - yScale(d);
          })
          .attr('fill', 'darkred');

        // Renders the yAxis once the chart is finished
        // >> Moves it to the left 10 pixels so it doesn't overlap
        chart.append('g')
          .attr('class', 'axis')
          .attr('transform', 'translate(-10, 0)')
          .call(yAxis);
      }

      $(function(){
        // On document load, call the render() function to load the graph
        render();

        // On button click, clear graph and reload
        $('button').click(function(){
          $('svg').remove();
          render();
        });
      })

    </script>
  </body>
</html>
